---
import CATS from "@/data/services-categories.json";
---

<section id="servicios" class="bg-white">
  <div class="mx-auto max-w-7xl px-4 py-16">
    <header class="flex items-end justify-between gap-4">
      <div>
        <p class="uppercase text-sm tracking-wide text-brand font-semibold">
          Nuestros servicios
        </p>
        <h2 class="mt-2 text-3xl md:text-4xl font-bold text-[rgb(8,62,82)]">
          Nos especializamos en
        </h2>
        <p class="mt-3 text-slate-600 max-w-3xl">
          Soluciones integrales en <strong>INGENIERÍA, MEDIO AMBIENTE y
          OPERACIÓN</strong>. Selecciona una categoría para explorar los
          servicios asociados.
        </p>
      </div>
      <a
        href="/services"
        class="inline-flex items-center gap-2 text-brand font-semibold hover:underline"
      >
        Ver todos
        <span aria-hidden>→</span>
      </a>
    </header>

    <!-- Grid de categorías estilizadas -->
    <div class="mt-12 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
      {CATS.categories.map((cat) => {
        // genera un nombre de imagen seguro
        const safeName = cat.name
          .normalize("NFD")
          .replace(/[\u0300-\u036f]/g, "")
          .toLowerCase()
          .replace(/[^a-z0-9]+/g, "-");
        const imagePath = `/images/categories/${safeName}.webp`;
        const fallback = "/images/categories/default.webp"; // imagen por defecto

        return (
          <a
            href={`/services?cat=${encodeURIComponent(cat.name)}`}
            class="group block overflow-hidden rounded-2xl bg-white border border-slate-200 shadow-sm hover:shadow-lg hover:border-[rgba(11,122,163,.35)] transition-all duration-300"
          >
            <!-- Imagen superior -->
            <div class="relative h-44 w-full overflow-hidden">
              <img
                src={imagePath}
                alt={cat.name}
                class="absolute inset-0 h-full w-full object-cover transition-transform duration-500 group-hover:scale-105"
                loading="lazy"
                onerror={`this.src='${fallback}'`}
              />
              <div class="absolute inset-0 bg-gradient-to-t from-[rgba(0,0,0,.4)] to-transparent"></div>
              <span
                class="absolute bottom-3 left-4 rounded-md bg-white/80 px-3 py-1 text-xs font-semibold text-[rgb(8,62,82)] shadow-sm"
              >
                {cat.name}
              </span>
            </div>

            <!-- Cuerpo -->
            <div class="p-6 flex flex-col justify-between min-h-[200px]">
              <div>
                <h3
                  class="text-lg font-semibold text-[rgb(8,62,82)] group-hover:text-[rgb(11,122,163)] transition-colors"
                >
                  {cat.name}
                </h3>
                <ul class="mt-3 text-slate-600 text-sm space-y-1">
                  {cat.items.slice(0, 3).map((item) => (
                    <li class="flex items-start gap-1">
                      <span class="text-[rgb(11,122,163)]">•</span>
                      <span>{item}</span>
                    </li>
                  ))}
                </ul>
              </div>

              <div class="mt-5 flex items-center justify-between">
                <span
                  class="text-[rgb(11,122,163)] text-sm font-medium inline-flex items-center gap-1 group-hover:gap-2 transition-all"
                >
                  Ver servicios
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    class="transition-transform duration-300 group-hover:translate-x-1"
                  >
                    <path
                      fill="currentColor"
                      d="M13 5l7 7l-7 7v-4H4v-6h9z"
                    ></path>
                  </svg>
                </span>

                <!-- Chip de categoría -->
                <span
                  class="rounded-full bg-[rgba(11,122,163,.08)] border border-[rgba(11,122,163,.2)] px-3 py-1 text-[11px] font-semibold text-[rgb(8,62,82)]"
                >
                  {cat.name.split(" ")[0]}
                </span>
              </div>
            </div>
          </a>
        );
      })}
    </div>
  </div>
</section>
